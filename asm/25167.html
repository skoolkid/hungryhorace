<!DOCTYPE html>
<html>
<head>
<title>Hungry Horace: Routine at 624F</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="24576.html">6000</a></span></td>
<td class="up">Up: <a href="../maps/all.html#25167">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="25399.html">6337</a></span></td>
</tr>
</table>
<div class="description">624F: Read the keyboard and update Horace's sprite accordingly</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="24576.html">6000</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25167"></span>624F</td>
<td class="instruction">LD A,(<a href="31865.html">$7C79</a>)</td>
<td class="comment-11" rowspan="1">Pick up the tunnel timer.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25170"></span>6252</td>
<td class="instruction">AND A</td>
<td class="comment-11" rowspan="1">Is Horace in a tunnel at the moment?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25171"></span>6253</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if so.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25172"></span>6254</td>
<td class="instruction">LD A,$FF</td>
<td class="comment-11" rowspan="2">Initialise the direction keypress to 'no key'.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25174"></span>6256</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25177"></span>6259</td>
<td class="instruction">LD A,(<a href="27403.html">$6B0B</a>)</td>
<td class="comment-11" rowspan="1">Pick up the game mode indicator.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25180"></span>625C</td>
<td class="instruction">AND A</td>
<td class="comment-11" rowspan="1">Is it demo mode?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25181"></span>625D</td>
<td class="instruction">JR NZ,<a href="25167.html#25284">$62C4</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25183"></span>625F</td>
<td class="instruction">LD A,$00</td>
<td class="comment-11" rowspan="2">Read the keyboard.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25185"></span>6261</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25187"></span>6263</td>
<td class="instruction">AND $1F</td>
<td class="comment-11" rowspan="2">Is a key being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25189"></span>6265</td>
<td class="instruction">CP $1F</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25191"></span>6267</td>
<td class="instruction">JR Z,<a href="25167.html#25197">$626D</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25193"></span>6269</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Drop the return address from the stack.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25194"></span>626A</td>
<td class="instruction">JP <a href="26426.html#26601">$67E9</a></td>
<td class="comment-11" rowspan="1">Cycle the screen colours briefly and return to the title screen.</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="25197"></span>
<div class="comments">
<div class="paragraph">
It's demo mode. Time to figure out where to move Horace next.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25197"></span>626D</td>
<td class="instruction">LD B,$04</td>
<td class="comment-11" rowspan="1">Initialise <span class="register">B</span> (the direction indicator) for the loop that follows.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25199"></span>626F</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="1"><span class="register">B</span>=3 (left), 2 (down), 1 (right) or 0 (up).</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25200"></span>6270</td>
<td class="instruction">LD HL,(<a href="31851.html">$7C6B</a>)</td>
<td class="comment-11" rowspan="1">Pick up Horace's current location.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25203"></span>6273</td>
<td class="instruction">LD C,$00</td>
<td class="comment-11" rowspan="1">Initialise <span class="register">C</span> to 0; this is the direction probability parameter.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25205"></span>6275</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1">Save the direction indicator briefly.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25206"></span>6276</td>
<td class="instruction">LD A,B</td>
<td class="comment-11" rowspan="1">Copy the direction indicator to <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25207"></span>6277</td>
<td class="instruction">CALL <a href="27842.html">$6CC2</a></td>
<td class="comment-11" rowspan="1">Check the tiles next to Horace in that direction.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25210"></span>627A</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1">Restore the direction indicator to <span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25211"></span>627B</td>
<td class="instruction">CP $02</td>
<td class="comment-11" rowspan="1">Is there a wall or the maze exit or entrance in that direction?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25213"></span>627D</td>
<td class="instruction">JP NC,<a href="25167.html#25247">$629F</a></td>
<td class="comment-11" rowspan="1">Jump if so with <span class="register">C</span>=0: that direction is blocked.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25216"></span>6280</td>
<td class="instruction">CALL <a href="27410.html">$6B12</a></td>
<td class="comment-11" rowspan="4">Set <span class="register">C</span> to a pseudo-random number between 25 and 56; the higher this value, the more likely Horace will turn 90 degrees in the direction indicated by <span class="register">B</span> when his path is blocked.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25219"></span>6283</td>
<td class="instruction">AND $1F</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25221"></span>6285</td>
<td class="instruction">ADD A,$19</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25223"></span>6287</td>
<td class="instruction">LD C,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25224"></span>6288</td>
<td class="instruction">LD A,(<a href="31856.html">$7C70</a>)</td>
<td class="comment-11" rowspan="1">Pick up Horace's animation frame.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25227"></span>628B</td>
<td class="instruction">CP B</td>
<td class="comment-11" rowspan="1">Is it equal to the current value of the direction indicator?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25228"></span>628C</td>
<td class="instruction">JR NZ,<a href="25167.html#25236">$6294</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25230"></span>628E</td>
<td class="instruction">LD A,$28</td>
<td class="comment-11" rowspan="3">Now <span class="register">C</span> holds a pseudo-random number between 65 and 96; this value ensures that Horace will keep moving in the same direction if he can.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25232"></span>6290</td>
<td class="instruction">ADD A,C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25233"></span>6291</td>
<td class="instruction">LD C,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25234"></span>6292</td>
<td class="instruction">JR <a href="25167.html#25247">$629F</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25236"></span>6294</td>
<td class="instruction">ADD A,$02</td>
<td class="comment-11" rowspan="2">Add 2 to Horace's animation frame; this has the effect of toggling his direction between up/down and left/right.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25238"></span>6296</td>
<td class="instruction">AND $03</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25240"></span>6298</td>
<td class="instruction">CP B</td>
<td class="comment-11" rowspan="1">Is it equal to the current value of the direction indicator now?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25241"></span>6299</td>
<td class="instruction">JR NZ,<a href="25167.html#25247">$629F</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25243"></span>629B</td>
<td class="instruction">LD A,$F6</td>
<td class="comment-11" rowspan="3">Now <span class="register">C</span> holds a pseudo-random number between 15 and 46; the higher this value, the more likely Horace will turn round 180 degrees when his path is blocked.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25245"></span>629D</td>
<td class="instruction">ADD A,C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25246"></span>629E</td>
<td class="instruction">LD C,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25247"></span>629F</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1">Save the direction indicator briefly.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25248"></span>62A0</td>
<td class="instruction">LD HL,<a href="28082.html">$6DB2</a></td>
<td class="comment-11" rowspan="4">Point <span class="register">HL</span> at one of the four slots at <a href="28082.html">6DB2</a>.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25251"></span>62A3</td>
<td class="instruction">LD C,B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25252"></span>62A4</td>
<td class="instruction">LD B,$00</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25254"></span>62A6</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25255"></span>62A7</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1">Restore the direction indicator to <span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25256"></span>62A8</td>
<td class="instruction">LD A,C</td>
<td class="comment-11" rowspan="2">Save the direction probability parameter in the appropriate slot.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25257"></span>62A9</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25258"></span>62AA</td>
<td class="instruction">INC B</td>
<td class="comment-11" rowspan="2">Have we considered every direction yet?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25259"></span>62AB</td>
<td class="instruction">DEC B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25260"></span>62AC</td>
<td class="instruction">JR NZ,<a href="25167.html#25199">$626F</a></td>
<td class="comment-11" rowspan="1">Jump back if not.</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="25262"></span>
<div class="comments">
<div class="paragraph">
Having computed a direction probability parameter for each of the four slots at <a href="28082.html">6DB2</a>, we now use those parameters to determine Horace's next animation frame (and therefore direction of travel).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25262"></span>62AE</td>
<td class="instruction">XOR A</td>
<td class="comment-11" rowspan="12">Compute in <span class="register">C</span> the index of the slot that holds the largest number (0, 1, 2 or 3).</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25263"></span>62AF</td>
<td class="instruction">LD HL,$6DB6</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25266"></span>62B2</td>
<td class="instruction">LD B,$04</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25268"></span>62B4</td>
<td class="instruction">DEC B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25269"></span>62B5</td>
<td class="instruction">DEC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25270"></span>62B6</td>
<td class="instruction">CP (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25271"></span>62B7</td>
<td class="instruction">JR NC,<a href="25167.html#25275">$62BB</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25273"></span>62B9</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25274"></span>62BA</td>
<td class="instruction">LD C,B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25275"></span>62BB</td>
<td class="instruction">INC B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25276"></span>62BC</td>
<td class="instruction">DEC B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25277"></span>62BD</td>
<td class="instruction">JR NZ,<a href="25167.html#25268">$62B4</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25279"></span>62BF</td>
<td class="instruction">LD A,C</td>
<td class="comment-11" rowspan="2">Update Horace's animation frame to this index value.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25280"></span>62C0</td>
<td class="instruction">LD (<a href="31856.html">$7C70</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25283"></span>62C3</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="25284"></span>
<div class="comments">
<div class="paragraph">
A game is in progress.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25284"></span>62C4</td>
<td class="instruction">LD A,$FB</td>
<td class="comment-11" rowspan="2">Read keys Q-W-E-R-T.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25286"></span>62C6</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25288"></span>62C8</td>
<td class="instruction">AND $01</td>
<td class="comment-11" rowspan="1">Is 'Q' (up) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25290"></span>62CA</td>
<td class="instruction">JR Z,<a href="25167.html#25300">$62D4</a></td>
<td class="comment-11" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25292"></span>62CC</td>
<td class="instruction">LD A,$F7</td>
<td class="comment-11" rowspan="2">Read keys 1-2-3-4-5.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25294"></span>62CE</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25296"></span>62D0</td>
<td class="instruction">AND $08</td>
<td class="comment-11" rowspan="1">Is '4' (up) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25298"></span>62D2</td>
<td class="instruction">JR NZ,<a href="25167.html#25307">$62DB</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25300"></span>62D4</td>
<td class="instruction">LD A,$00</td>
<td class="comment-11" rowspan="2">Signal: 'up' key pressed.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25302"></span>62D6</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25305"></span>62D9</td>
<td class="instruction">JR <a href="25167.html#25374">$631E</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25307"></span>62DB</td>
<td class="instruction">LD A,$FE</td>
<td class="comment-11" rowspan="2">Read keys SHIFT-Z-X-C-V.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25309"></span>62DD</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25311"></span>62DF</td>
<td class="instruction">AND $02</td>
<td class="comment-11" rowspan="1">is 'Z' (down) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25313"></span>62E1</td>
<td class="instruction">JR Z,<a href="25167.html#25323">$62EB</a></td>
<td class="comment-11" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25315"></span>62E3</td>
<td class="instruction">LD A,$F7</td>
<td class="comment-11" rowspan="1">Read keys 1-2-3-4-5.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25317"></span>62E5</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-11" rowspan="1">is '3' (down) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25319"></span>62E7</td>
<td class="instruction">AND $04</td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25321"></span>62E9</td>
<td class="instruction">JR NZ,<a href="25167.html#25330">$62F2</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25323"></span>62EB</td>
<td class="instruction">LD A,$02</td>
<td class="comment-11" rowspan="2">Signal: 'down' key pressed.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25325"></span>62ED</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25328"></span>62F0</td>
<td class="instruction">JR <a href="25167.html#25374">$631E</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25330"></span>62F2</td>
<td class="instruction">LD A,$DF</td>
<td class="comment-11" rowspan="2">Read keys Y-U-I-O-P.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25332"></span>62F4</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25334"></span>62F6</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1">Is 'P' (right) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25336"></span>62F8</td>
<td class="instruction">JR Z,<a href="25167.html#25346">$6302</a></td>
<td class="comment-11" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25338"></span>62FA</td>
<td class="instruction">LD A,$F7</td>
<td class="comment-11" rowspan="2">Read keys 1-2-3-4-5.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25340"></span>62FC</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25342"></span>62FE</td>
<td class="instruction">AND $02</td>
<td class="comment-11" rowspan="1">is '2' (right) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25344"></span>6300</td>
<td class="instruction">JR NZ,<a href="25167.html#25353">$6309</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25346"></span>6302</td>
<td class="instruction">LD A,$01</td>
<td class="comment-11" rowspan="2">Signal: 'right' key pressed.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25348"></span>6304</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25351"></span>6307</td>
<td class="instruction">JR <a href="25167.html#25374">$631E</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25353"></span>6309</td>
<td class="instruction">LD A,$DF</td>
<td class="comment-11" rowspan="2">Read keys Y-U-I-O-P.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25355"></span>630B</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25357"></span>630D</td>
<td class="instruction">BIT 2,A</td>
<td class="comment-11" rowspan="1">Is 'I' (left) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25359"></span>630F</td>
<td class="instruction">JR Z,<a href="25167.html#25369">$6319</a></td>
<td class="comment-11" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25361"></span>6311</td>
<td class="instruction">LD A,$F7</td>
<td class="comment-11" rowspan="2">Read keys 1-2-3-4-5.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25363"></span>6313</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25365"></span>6315</td>
<td class="instruction">AND $01</td>
<td class="comment-11" rowspan="1">is '1' (left) being pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25367"></span>6317</td>
<td class="instruction">JR NZ,<a href="25167.html#25389">$632D</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25369"></span>6319</td>
<td class="instruction">LD A,$03</td>
<td class="comment-11" rowspan="2">Signal: 'left' key pressed.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25371"></span>631B</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25374"></span>631E</td>
<td class="instruction">LD HL,(<a href="31851.html">$7C6B</a>)</td>
<td class="comment-11" rowspan="1">Pick up Horace's current location.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25377"></span>6321</td>
<td class="instruction">CALL <a href="27842.html">$6CC2</a></td>
<td class="comment-11" rowspan="1">Check the tiles in front of Horace.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25380"></span>6324</td>
<td class="instruction">CP $03</td>
<td class="comment-11" rowspan="1">Is Horace facing a wall?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25382"></span>6326</td>
<td class="instruction">JR NZ,<a href="25167.html#25389">$632D</a></td>
<td class="comment-11" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25384"></span>6328</td>
<td class="instruction">LD A,$FF</td>
<td class="comment-11" rowspan="2">Signal: no key pressed (Horace will not respond to the keypress).</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25386"></span>632A</td>
<td class="instruction">LD (<a href="31855.html">$7C6F</a>),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="25389"></span>632D</td>
<td class="instruction">LD A,(<a href="31855.html">$7C6F</a>)</td>
<td class="comment-11" rowspan="1">Pick up the direction keypress indicator.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25392"></span>6330</td>
<td class="instruction">CP $FF</td>
<td class="comment-11" rowspan="1">Was a direction key pressed?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25394"></span>6332</td>
<td class="instruction">RET Z</td>
<td class="comment-11" rowspan="1">Return if not.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25395"></span>6333</td>
<td class="instruction">LD (<a href="31856.html">$7C70</a>),A</td>
<td class="comment-11" rowspan="1">Otherwise update Horace's animation frame accordingly.</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="25398"></span>6336</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="24576.html">6000</a></span></td>
<td class="up">Up: <a href="../maps/all.html#25167">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="25399.html">6337</a></span></td>
</tr>
</table>
<footer>
<div class="release">The complete Hungry Horace RAM disassembly 20171205</div>
<div class="copyright">&#169; 1982 Beam Software. &#169; 2017 Richard Dymond.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 6.1.</div>
</footer>
</body>
</html>