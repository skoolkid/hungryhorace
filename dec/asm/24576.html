<!DOCTYPE html>
<html>
<head>
<title>Hungry Horace: Routine at 24576</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Hungry Horace" src="../../images/logo-dec.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
</td>
<td class="up">Up: <a href="../maps/all.html#24576">Map</a></td>
<td class="next">
Next: <a href="25129.html">25129</a>
</td>
</tr>
</table>
<div class="description">24576: The game has just loaded</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="24576"></span>24576</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="address-1"><span id="24577"></span>24577</td>
<td class="instruction">LD A,(23672)</td>
<td class="comment-1" rowspan="9">Initialise the pseudo-random number address.</td>
</tr>
<tr>
<td class="address-1"><span id="24580"></span>24580</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="address-1"><span id="24581"></span>24581</td>
<td class="instruction">AND 31</td>
</tr>
<tr>
<td class="address-1"><span id="24583"></span>24583</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="address-1"><span id="24584"></span>24584</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24585"></span>24585</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="address-1"><span id="24586"></span>24586</td>
<td class="instruction">AND 31</td>
</tr>
<tr>
<td class="address-1"><span id="24588"></span>24588</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="address-1"><span id="24589"></span>24589</td>
<td class="instruction">LD (<a href="31847.html">31847</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="24592"></span>24592</td>
<td class="instruction">LD HL,<a href="31850.html">31850</a></td>
<td class="comment-1" rowspan="2">Initialise the 'T' pressed indicator to 'off' (bit 4 set).</td>
</tr>
<tr>
<td class="address-1"><span id="24595"></span>24595</td>
<td class="instruction">LD (HL),16</td>
</tr>
<tr>
<td class="address-1"><span id="24597"></span>24597</td>
<td class="instruction">LD HL,<a href="31849.html">31849</a></td>
<td class="comment-1" rowspan="2">Initialise the sound indicator to 'on'.</td>
</tr>
<tr>
<td class="address-1"><span id="24600"></span>24600</td>
<td class="instruction">LD (HL),31</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="24602"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="26426.html">26426</a> when a game has ended.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="24602"></span>24602</td>
<td class="instruction">LD HL,22528</td>
<td class="comment-1" rowspan="5">INK 7: PAPER 7</td>
</tr>
<tr>
<td class="address-1"><span id="24605"></span>24605</td>
<td class="instruction">LD DE,22529</td>
</tr>
<tr>
<td class="address-1"><span id="24608"></span>24608</td>
<td class="instruction">LD BC,767</td>
</tr>
<tr>
<td class="address-1"><span id="24611"></span>24611</td>
<td class="instruction">LD (HL),63</td>
</tr>
<tr>
<td class="address-1"><span id="24613"></span>24613</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="24615"></span>24615</td>
<td class="instruction">LD HL,16384</td>
<td class="comment-1" rowspan="5">Clear the display file.</td>
</tr>
<tr>
<td class="address-1"><span id="24618"></span>24618</td>
<td class="instruction">LD DE,16385</td>
</tr>
<tr>
<td class="address-1"><span id="24621"></span>24621</td>
<td class="instruction">LD BC,6143</td>
</tr>
<tr>
<td class="address-1"><span id="24624"></span>24624</td>
<td class="instruction">LD (HL),0</td>
</tr>
<tr>
<td class="address-1"><span id="24626"></span>24626</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="24628"></span>24628</td>
<td class="instruction">LD HL,22528</td>
<td class="comment-1" rowspan="5">INK 0: PAPER 7</td>
</tr>
<tr>
<td class="address-1"><span id="24631"></span>24631</td>
<td class="instruction">LD DE,22529</td>
</tr>
<tr>
<td class="address-1"><span id="24634"></span>24634</td>
<td class="instruction">LD BC,767</td>
</tr>
<tr>
<td class="address-1"><span id="24637"></span>24637</td>
<td class="instruction">LD (HL),56</td>
</tr>
<tr>
<td class="address-1"><span id="24639"></span>24639</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="24641"></span>24641</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="2">Signal demo mode.</td>
</tr>
<tr>
<td class="address-1"><span id="24643"></span>24643</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24646"></span>24646</td>
<td class="instruction">LD HL,140</td>
<td class="comment-1" rowspan="2">Initialise the title screen countdown timer.</td>
</tr>
<tr>
<td class="address-1"><span id="24649"></span>24649</td>
<td class="instruction">LD (<a href="27400.html">27400</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="24652"></span>24652</td>
<td class="instruction">LD DE,16544</td>
<td class="comment-1" rowspan="4">Print 'HUNGRY' in big letters.</td>
</tr>
<tr>
<td class="address-1"><span id="24655"></span>24655</td>
<td class="instruction">LD HL,<a href="28303.html">28303</a></td>
</tr>
<tr>
<td class="address-1"><span id="24658"></span>24658</td>
<td class="instruction">LD BC,160</td>
</tr>
<tr>
<td class="address-1"><span id="24661"></span>24661</td>
<td class="instruction">CALL <a href="27982.html">27982</a></td>
</tr>
<tr>
<td class="address-1"><span id="24664"></span>24664</td>
<td class="instruction">LD DE,18560</td>
<td class="comment-1" rowspan="4">Print 'HORACE' in big letters.</td>
</tr>
<tr>
<td class="address-1"><span id="24667"></span>24667</td>
<td class="instruction">LD HL,<a href="28463.html">28463</a></td>
</tr>
<tr>
<td class="address-1"><span id="24670"></span>24670</td>
<td class="instruction">LD BC,160</td>
</tr>
<tr>
<td class="address-1"><span id="24673"></span>24673</td>
<td class="instruction">CALL <a href="27982.html">27982</a></td>
</tr>
<tr>
<td class="address-1"><span id="24676"></span>24676</td>
<td class="instruction">LD A,(<a href="27403.html">27403</a>)</td>
<td class="comment-1" rowspan="1">Pick up the game mode indicator.</td>
</tr>
<tr>
<td class="address-1"><span id="24679"></span>24679</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Save it briefly.</td>
</tr>
<tr>
<td class="address-1"><span id="24680"></span>24680</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="2">Signal game mode (to force the copyright message to be printed).</td>
</tr>
<tr>
<td class="address-1"><span id="24682"></span>24682</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24685"></span>24685</td>
<td class="instruction">LD HL,20672</td>
<td class="comment-1" rowspan="1">This is the display file address for the copyright message.</td>
</tr>
<tr>
<td class="address-1"><span id="24688"></span>24688</td>
<td class="instruction">CALL <a href="27663.html">27663</a></td>
<td class="comment-1" rowspan="1">Set <span class="register">HL'</span> to the corresponding attribute file address (unnecessarily).</td>
</tr>
<tr>
<td class="address-1"><span id="24691"></span>24691</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Transfer the display file address to <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="24692"></span>24692</td>
<td class="instruction">LD HL,<a href="27303.html">27303</a></td>
<td class="comment-1" rowspan="7">Print 'Copyright &#169; 1982 Beam Software' and 'PRESS ANY KEY TO START PLAY'.</td>
</tr>
<tr>
<td class="address-2"><span id="24695"></span>24695</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24696"></span>24696</td>
<td class="instruction">CP 255</td>
</tr>
<tr>
<td class="address-1"><span id="24698"></span>24698</td>
<td class="instruction">JR Z,<a href="24576.html#24706">24706</a></td>
</tr>
<tr>
<td class="address-1"><span id="24700"></span>24700</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="24701"></span>24701</td>
<td class="instruction">CALL <a href="27464.html#27471">27471</a></td>
</tr>
<tr>
<td class="address-1"><span id="24704"></span>24704</td>
<td class="instruction">JR <a href="24576.html#24695">24695</a></td>
</tr>
<tr>
<td class="address-2"><span id="24706"></span>24706</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="2">Restore the game mode indicator.</td>
</tr>
<tr>
<td class="address-1"><span id="24707"></span>24707</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-2"><span id="24710"></span>24710</td>
<td class="instruction">LD HL,22688</td>
<td class="comment-1" rowspan="18">Change the colour of the words 'HUNGRY HORACE' on the title screen.</td>
</tr>
<tr>
<td class="address-1"><span id="24713"></span>24713</td>
<td class="instruction">LD DE,22689</td>
</tr>
<tr>
<td class="address-1"><span id="24716"></span>24716</td>
<td class="instruction">LD BC,159</td>
</tr>
<tr>
<td class="address-1"><span id="24719"></span>24719</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24720"></span>24720</td>
<td class="instruction">INC A</td>
</tr>
<tr>
<td class="address-1"><span id="24721"></span>24721</td>
<td class="instruction">AND 63</td>
</tr>
<tr>
<td class="address-1"><span id="24723"></span>24723</td>
<td class="instruction">OR 56</td>
</tr>
<tr>
<td class="address-1"><span id="24725"></span>24725</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="address-1"><span id="24726"></span>24726</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="24728"></span>24728</td>
<td class="instruction">LD HL,22912</td>
</tr>
<tr>
<td class="address-1"><span id="24731"></span>24731</td>
<td class="instruction">LD DE,22913</td>
</tr>
<tr>
<td class="address-1"><span id="24734"></span>24734</td>
<td class="instruction">LD BC,159</td>
</tr>
<tr>
<td class="address-1"><span id="24737"></span>24737</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24738"></span>24738</td>
<td class="instruction">INC A</td>
</tr>
<tr>
<td class="address-1"><span id="24739"></span>24739</td>
<td class="instruction">AND 63</td>
</tr>
<tr>
<td class="address-1"><span id="24741"></span>24741</td>
<td class="instruction">OR 56</td>
</tr>
<tr>
<td class="address-1"><span id="24743"></span>24743</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="address-1"><span id="24744"></span>24744</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="address-1"><span id="24746"></span>24746</td>
<td class="instruction">CALL <a href="27255.html">27255</a></td>
<td class="comment-1" rowspan="1">Make the title screen sound effect.</td>
</tr>
<tr>
<td class="address-1"><span id="24749"></span>24749</td>
<td class="instruction">LD HL,(<a href="27400.html">27400</a>)</td>
<td class="comment-1" rowspan="3">Decrement the title screen countdown timer.</td>
</tr>
<tr>
<td class="address-1"><span id="24752"></span>24752</td>
<td class="instruction">DEC HL</td>
</tr>
<tr>
<td class="address-1"><span id="24753"></span>24753</td>
<td class="instruction">LD (<a href="27400.html">27400</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="24756"></span>24756</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="2">Is it zero now?</td>
</tr>
<tr>
<td class="address-1"><span id="24757"></span>24757</td>
<td class="instruction">OR L</td>
</tr>
<tr>
<td class="address-1"><span id="24758"></span>24758</td>
<td class="instruction">JR Z,<a href="24576.html#24777">24777</a></td>
<td class="comment-1" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="address-1"><span id="24760"></span>24760</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="2">Read the keyboard.</td>
</tr>
<tr>
<td class="address-1"><span id="24762"></span>24762</td>
<td class="instruction">IN A,(254)</td>
</tr>
<tr>
<td class="address-1"><span id="24764"></span>24764</td>
<td class="instruction">AND 31</td>
<td class="comment-1" rowspan="2">Is a key being pressed?</td>
</tr>
<tr>
<td class="address-1"><span id="24766"></span>24766</td>
<td class="instruction">CP 31</td>
</tr>
<tr>
<td class="address-1"><span id="24768"></span>24768</td>
<td class="instruction">JR Z,<a href="24576.html#24710">24710</a></td>
<td class="comment-1" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="address-1"><span id="24770"></span>24770</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="2">Signal that a game (not demo mode) has started.</td>
</tr>
<tr>
<td class="address-1"><span id="24772"></span>24772</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24775"></span>24775</td>
<td class="instruction">JR <a href="24576.html#24777">24777</a></td>
<td class="comment-1" rowspan="1">This instruction is redundant.</td>
</tr>
<tr>
<td class="address-2"><span id="24777"></span>24777</td>
<td class="instruction">LD A,255</td>
<td class="comment-1" rowspan="2">Initialise the maze number.</td>
</tr>
<tr>
<td class="address-1"><span id="24779"></span>24779</td>
<td class="instruction">LD (<a href="31843.html">31843</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24782"></span>24782</td>
<td class="instruction">LD A,8</td>
<td class="comment-1" rowspan="2">Initialise the game speed parameter.</td>
</tr>
<tr>
<td class="address-1"><span id="24784"></span>24784</td>
<td class="instruction">LD (<a href="31842.html">31842</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24787"></span>24787</td>
<td class="instruction">LD A,3</td>
<td class="comment-1" rowspan="2">Initialise the number of lives remaining.</td>
</tr>
<tr>
<td class="address-1"><span id="24789"></span>24789</td>
<td class="instruction">LD (<a href="31864.html">31864</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24792"></span>24792</td>
<td class="instruction">LD HL,0</td>
<td class="comment-1" rowspan="2">Initialise the score.</td>
</tr>
<tr>
<td class="address-1"><span id="24795"></span>24795</td>
<td class="instruction">LD (<a href="31859.html">31859</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="24798"></span>24798</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="2">Initialise the active guard counter.</td>
</tr>
<tr>
<td class="address-1"><span id="24800"></span>24800</td>
<td class="instruction">LD (<a href="27402.html">27402</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24803"></span>24803</td>
<td class="instruction">LD (<a href="31863.html">31863</a>),A</td>
<td class="comment-1" rowspan="1">Initialise the extra life indicator.</td>
</tr>
<tr>
<td class="address-1"><span id="24806"></span>24806</td>
<td class="instruction">CALL <a href="27170.html">27170</a></td>
<td class="comment-1" rowspan="1">Initialise the guard countdown timers.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="24809"></span>
<div class="comments">
<div class="paragraph">
This entry point is used when moving from one maze to the next by the routines at <a href="26426.html">26426</a> (in demo mode) and <a href="27166.html">27166</a> (in game mode).
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="24809"></span>24809</td>
<td class="instruction">LD A,(<a href="31843.html">31843</a>)</td>
<td class="comment-1" rowspan="1">Pick up the current maze number (0-3).</td>
</tr>
<tr>
<td class="address-1"><span id="24812"></span>24812</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="2">Is it 0, 1 or 2?</td>
</tr>
<tr>
<td class="address-1"><span id="24813"></span>24813</td>
<td class="instruction">AND 252</td>
</tr>
<tr>
<td class="address-1"><span id="24815"></span>24815</td>
<td class="instruction">JR Z,<a href="24576.html#24828">24828</a></td>
<td class="comment-1" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="address-1"><span id="24817"></span>24817</td>
<td class="instruction">LD A,(<a href="31842.html">31842</a>)</td>
<td class="comment-1" rowspan="5">Decrement the game speed parameter (unless it's already 1). This increases the speed of the game.</td>
</tr>
<tr>
<td class="address-1"><span id="24820"></span>24820</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="address-1"><span id="24821"></span>24821</td>
<td class="instruction">JR NZ,<a href="24576.html#24825">24825</a></td>
</tr>
<tr>
<td class="address-1"><span id="24823"></span>24823</td>
<td class="instruction">LD A,1</td>
</tr>
<tr>
<td class="address-2"><span id="24825"></span>24825</td>
<td class="instruction">LD (<a href="31842.html">31842</a>),A</td>
</tr>
<tr>
<td class="address-2"><span id="24828"></span>24828</td>
<td class="instruction">LD A,(<a href="31843.html">31843</a>)</td>
<td class="comment-1" rowspan="4">Increment the maze number.</td>
</tr>
<tr>
<td class="address-1"><span id="24831"></span>24831</td>
<td class="instruction">INC A</td>
</tr>
<tr>
<td class="address-1"><span id="24832"></span>24832</td>
<td class="instruction">AND 3</td>
</tr>
<tr>
<td class="address-1"><span id="24834"></span>24834</td>
<td class="instruction">LD (<a href="31843.html">31843</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24837"></span>24837</td>
<td class="instruction">LD A,(<a href="31843.html">31843</a>)</td>
<td class="comment-1" rowspan="1">Pick up the current maze number.</td>
</tr>
<tr>
<td class="address-1"><span id="24840"></span>24840</td>
<td class="instruction">CP 0</td>
<td class="comment-1" rowspan="1">Is it maze 1?</td>
</tr>
<tr>
<td class="address-1"><span id="24842"></span>24842</td>
<td class="instruction">JR NZ,<a href="24576.html#24855">24855</a></td>
<td class="comment-1" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="address-1"><span id="24844"></span>24844</td>
<td class="instruction">LD HL,<a href="28631.html">28631</a></td>
<td class="comment-1" rowspan="2">Copy the tunnel offset and bell, initial guard and entrance locations for maze 1 to <a href="28623.html">28623</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="24847"></span>24847</td>
<td class="instruction">CALL <a href="27294.html">27294</a></td>
</tr>
<tr>
<td class="address-1"><span id="24850"></span>24850</td>
<td class="instruction">LD HL,<a href="29431.html">29431</a></td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the layout data for maze 1.</td>
</tr>
<tr>
<td class="address-1"><span id="24853"></span>24853</td>
<td class="instruction">JR <a href="24576.html#24896">24896</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="24855"></span>24855</td>
<td class="instruction">CP 1</td>
<td class="comment-1" rowspan="1">Is it maze 2?</td>
</tr>
<tr>
<td class="address-1"><span id="24857"></span>24857</td>
<td class="instruction">JR NZ,<a href="24576.html#24870">24870</a></td>
<td class="comment-1" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="address-1"><span id="24859"></span>24859</td>
<td class="instruction">LD HL,<a href="28639.html">28639</a></td>
<td class="comment-1" rowspan="2">Copy the tunnel offset and bell, initial guard and entrance locations for maze 2 to <a href="28623.html">28623</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="24862"></span>24862</td>
<td class="instruction">CALL <a href="27294.html">27294</a></td>
</tr>
<tr>
<td class="address-1"><span id="24865"></span>24865</td>
<td class="instruction">LD HL,<a href="28663.html">28663</a></td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the layout data for maze 2.</td>
</tr>
<tr>
<td class="address-1"><span id="24868"></span>24868</td>
<td class="instruction">JR <a href="24576.html#24896">24896</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="24870"></span>24870</td>
<td class="instruction">CP 2</td>
<td class="comment-1" rowspan="1">Is it maze 3?</td>
</tr>
<tr>
<td class="address-1"><span id="24872"></span>24872</td>
<td class="instruction">JR NZ,<a href="24576.html#24885">24885</a></td>
<td class="comment-1" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="address-1"><span id="24874"></span>24874</td>
<td class="instruction">LD HL,<a href="28647.html">28647</a></td>
<td class="comment-1" rowspan="2">Copy the tunnel offset and bell, initial guard and entrance locations for maze 3 to <a href="28623.html">28623</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="24877"></span>24877</td>
<td class="instruction">CALL <a href="27294.html">27294</a></td>
</tr>
<tr>
<td class="address-1"><span id="24880"></span>24880</td>
<td class="instruction">LD HL,<a href="30199.html">30199</a></td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the layout data for maze 3.</td>
</tr>
<tr>
<td class="address-1"><span id="24883"></span>24883</td>
<td class="instruction">JR <a href="24576.html#24896">24896</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="24885"></span>24885</td>
<td class="instruction">LD HL,<a href="28655.html">28655</a></td>
<td class="comment-1" rowspan="2">Copy the tunnel offset and bell, initial guard and entrance locations for maze 4 to <a href="28623.html">28623</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="24888"></span>24888</td>
<td class="instruction">CALL <a href="27294.html">27294</a></td>
</tr>
<tr>
<td class="address-1"><span id="24891"></span>24891</td>
<td class="instruction">LD HL,<a href="30967.html">30967</a></td>
<td class="comment-1" rowspan="1">Point <span class="register">HL</span> at the layout data for maze 4.</td>
</tr>
<tr>
<td class="address-1"><span id="24894"></span>24894</td>
<td class="instruction">JR <a href="24576.html#24896">24896</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="24896"></span>24896</td>
<td class="instruction">LD DE,16384</td>
<td class="comment-1" rowspan="3">Draw the current maze.</td>
</tr>
<tr>
<td class="address-1"><span id="24899"></span>24899</td>
<td class="instruction">LD BC,768</td>
</tr>
<tr>
<td class="address-1"><span id="24902"></span>24902</td>
<td class="instruction">CALL <a href="27509.html">27509</a></td>
</tr>
<tr>
<td class="address-1"><span id="24905"></span>24905</td>
<td class="instruction">LD A,(<a href="27403.html">27403</a>)</td>
<td class="comment-1" rowspan="1">Pick up the game mode indicator.</td>
</tr>
<tr>
<td class="address-1"><span id="24908"></span>24908</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1">Is it demo mode?</td>
</tr>
<tr>
<td class="address-1"><span id="24909"></span>24909</td>
<td class="instruction">JR Z,<a href="24576.html#24932">24932</a></td>
<td class="comment-1" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="address-1"><span id="24911"></span>24911</td>
<td class="instruction">LD HL,16384</td>
<td class="comment-1" rowspan="1">This is the display file address for 'PASSES&#160;&#160;&#160;SCORE&#160;&#160;&#160;&#160;&#160;&#160;&#160;BEST'.</td>
</tr>
<tr>
<td class="address-1"><span id="24914"></span>24914</td>
<td class="instruction">CALL <a href="27663.html">27663</a></td>
<td class="comment-1" rowspan="1">Set <span class="register">HL'</span> to the corresponding attribute file address (unnecessarily).</td>
</tr>
<tr>
<td class="address-1"><span id="24917"></span>24917</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Transfer the display file address to <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="24918"></span>24918</td>
<td class="instruction">LD HL,<a href="31815.html">31815</a></td>
<td class="comment-1" rowspan="7">Print 'PASSES&#160;&#160;&#160;SCORE&#160;&#160;&#160;&#160;&#160;&#160;&#160;BEST'.</td>
</tr>
<tr>
<td class="address-2"><span id="24921"></span>24921</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24922"></span>24922</td>
<td class="instruction">CP 255</td>
</tr>
<tr>
<td class="address-1"><span id="24924"></span>24924</td>
<td class="instruction">JR Z,<a href="24576.html#24975">24975</a></td>
</tr>
<tr>
<td class="address-1"><span id="24926"></span>24926</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="24927"></span>24927</td>
<td class="instruction">CALL <a href="27464.html#27471">27471</a></td>
</tr>
<tr>
<td class="address-1"><span id="24930"></span>24930</td>
<td class="instruction">JR <a href="24576.html#24921">24921</a></td>
</tr>
<tr>
<td class="address-2"><span id="24932"></span>24932</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="2">Signal game mode (to force the 'DEMO MODE' text to be printed).</td>
</tr>
<tr>
<td class="address-1"><span id="24934"></span>24934</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24937"></span>24937</td>
<td class="instruction">LD HL,16384</td>
<td class="comment-1" rowspan="1">This is the display file address for 'DEMO MODE&#160;&#160;PRESS ANY KEY TO PLAY'.</td>
</tr>
<tr>
<td class="address-1"><span id="24940"></span>24940</td>
<td class="instruction">CALL <a href="27663.html">27663</a></td>
<td class="comment-1" rowspan="1">Set <span class="register">HL'</span> to the corresponding attribute file address (unnecessarily).</td>
</tr>
<tr>
<td class="address-1"><span id="24943"></span>24943</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Transfer the display file address to <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="24944"></span>24944</td>
<td class="instruction">LD HL,<a href="27367.html">27367</a></td>
<td class="comment-1" rowspan="7">Print 'DEMO MODE&#160;&#160;PRESS ANY KEY TO PLAY'.</td>
</tr>
<tr>
<td class="address-2"><span id="24947"></span>24947</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24948"></span>24948</td>
<td class="instruction">CP 255</td>
</tr>
<tr>
<td class="address-1"><span id="24950"></span>24950</td>
<td class="instruction">JR Z,<a href="24576.html#24958">24958</a></td>
</tr>
<tr>
<td class="address-1"><span id="24952"></span>24952</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="24953"></span>24953</td>
<td class="instruction">CALL <a href="27464.html#27471">27471</a></td>
</tr>
<tr>
<td class="address-1"><span id="24956"></span>24956</td>
<td class="instruction">JR <a href="24576.html#24947">24947</a></td>
</tr>
<tr>
<td class="address-2"><span id="24958"></span>24958</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="2">Restore the game mode indicator to demo mode.</td>
</tr>
<tr>
<td class="address-1"><span id="24960"></span>24960</td>
<td class="instruction">LD (<a href="27403.html">27403</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="24963"></span>24963</td>
<td class="instruction">LD HL,22528</td>
<td class="comment-1" rowspan="7">Make 'DEMO MODE' flash.</td>
</tr>
<tr>
<td class="address-1"><span id="24966"></span>24966</td>
<td class="instruction">LD B,9</td>
</tr>
<tr>
<td class="address-2"><span id="24968"></span>24968</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="address-1"><span id="24969"></span>24969</td>
<td class="instruction">ADD A,128</td>
</tr>
<tr>
<td class="address-1"><span id="24971"></span>24971</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="address-1"><span id="24972"></span>24972</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="24973"></span>24973</td>
<td class="instruction">DJNZ <a href="24576.html#24968">24968</a></td>
</tr>
<tr>
<td class="address-2"><span id="24975"></span>24975</td>
<td class="instruction">LD HL,(<a href="28623.html#28625">28625</a>)</td>
<td class="comment-1" rowspan="2">Copy the bell location to <a href="31940.html">31940</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="24978"></span>24978</td>
<td class="instruction">LD (<a href="31940.html">31940</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="24981"></span>24981</td>
<td class="instruction">LD HL,16391</td>
<td class="comment-1" rowspan="1">This is the display file address for the number of lives remaining.</td>
</tr>
<tr>
<td class="address-1"><span id="24984"></span>24984</td>
<td class="instruction">CALL <a href="27663.html">27663</a></td>
<td class="comment-1" rowspan="1">Set <span class="register">HL'</span> to the corresponding attribute file address (unnecessarily).</td>
</tr>
<tr>
<td class="address-1"><span id="24987"></span>24987</td>
<td class="instruction">LD A,(<a href="31864.html">31864</a>)</td>
<td class="comment-1" rowspan="1">Pick up the number of lives remaining.</td>
</tr>
<tr>
<td class="address-1"><span id="24990"></span>24990</td>
<td class="instruction">ADD A,"0"</td>
<td class="comment-1" rowspan="1">Convert it to the ASCII code for the corresponding digit.</td>
</tr>
<tr>
<td class="address-1"><span id="24992"></span>24992</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Transfer the display file address to <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="24993"></span>24993</td>
<td class="instruction">CALL <a href="27464.html#27471">27471</a></td>
<td class="comment-1" rowspan="1">Print the number of lives remaining.</td>
</tr>
<tr>
<td class="address-1"><span id="24996"></span>24996</td>
<td class="instruction">LD HL,2000</td>
<td class="comment-1" rowspan="2">Initialise the lunch-drop countdown timer.</td>
</tr>
<tr>
<td class="address-1"><span id="24999"></span>24999</td>
<td class="instruction">LD (<a href="31845.html">31845</a>),HL</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="25002"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="26426.html">26426</a> after Horace has lost a life.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="25002"></span>25002</td>
<td class="instruction">LD HL,(<a href="31940.html">31940</a>)</td>
<td class="comment-1" rowspan="1">Pick up the bell location.</td>
</tr>
<tr>
<td class="address-1"><span id="25005"></span>25005</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="2">Has Horace sounded the alarm?</td>
</tr>
<tr>
<td class="address-1"><span id="25006"></span>25006</td>
<td class="instruction">OR L</td>
</tr>
<tr>
<td class="address-1"><span id="25007"></span>25007</td>
<td class="instruction">JR Z,<a href="24576.html#25015">25015</a></td>
<td class="comment-1" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="address-1"><span id="25009"></span>25009</td>
<td class="instruction">LD HL,(<a href="28623.html#28625">28625</a>)</td>
<td class="comment-1" rowspan="2">Reinitialise the bell location.</td>
</tr>
<tr>
<td class="address-1"><span id="25012"></span>25012</td>
<td class="instruction">LD (<a href="31940.html">31940</a>),HL</td>
</tr>
<tr>
<td class="address-2"><span id="25015"></span>25015</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="1">There are four guards.</td>
</tr>
<tr>
<td class="address-2"><span id="25017"></span>25017</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="3">Copy the guard's buffer into the temporary location (<a href="28088.html">28088</a>).</td>
</tr>
<tr>
<td class="address-1"><span id="25018"></span>25018</td>
<td class="instruction">CALL <a href="27199.html">27199</a></td>
</tr>
<tr>
<td class="address-1"><span id="25021"></span>25021</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="address-1"><span id="25022"></span>25022</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Save the guard counter.</td>
</tr>
<tr>
<td class="address-1"><span id="25023"></span>25023</td>
<td class="instruction">SLA B</td>
<td class="comment-1" rowspan="6">Point <span class="register">HL</span> at one of the guard countdown timers at <a href="28070.html">28070</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="25025"></span>25025</td>
<td class="instruction">LD C,B</td>
</tr>
<tr>
<td class="address-1"><span id="25026"></span>25026</td>
<td class="instruction">LD B,0</td>
</tr>
<tr>
<td class="address-1"><span id="25028"></span>25028</td>
<td class="instruction">XOR A</td>
</tr>
<tr>
<td class="address-1"><span id="25029"></span>25029</td>
<td class="instruction">LD HL,28078</td>
</tr>
<tr>
<td class="address-1"><span id="25032"></span>25032</td>
<td class="instruction">SBC HL,BC</td>
</tr>
<tr>
<td class="address-1"><span id="25034"></span>25034</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="3">Is this guard in play?</td>
</tr>
<tr>
<td class="address-1"><span id="25035"></span>25035</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="25036"></span>25036</td>
<td class="instruction">OR (HL)</td>
</tr>
<tr>
<td class="address-1"><span id="25037"></span>25037</td>
<td class="instruction">JR NZ,<a href="24576.html#25044">25044</a></td>
<td class="comment-1" rowspan="1">Jump if not.</td>
</tr>
<tr>
<td class="address-1"><span id="25039"></span>25039</td>
<td class="instruction">LD HL,(<a href="28623.html#28627">28627</a>)</td>
<td class="comment-1" rowspan="1">Pick up the initial guard location for the current maze.</td>
</tr>
<tr>
<td class="address-1"><span id="25042"></span>25042</td>
<td class="instruction">JR <a href="24576.html#25047">25047</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="25044"></span>25044</td>
<td class="instruction">LD HL,(<a href="28623.html#28629">28629</a>)</td>
<td class="comment-1" rowspan="1">Pick up the bell location for the current maze.</td>
</tr>
<tr>
<td class="address-2"><span id="25047"></span>25047</td>
<td class="instruction">LD (<a href="28088.html">28088</a>),HL</td>
<td class="comment-1" rowspan="2">Initialise the guard's current and new locations.</td>
</tr>
<tr>
<td class="address-1"><span id="25050"></span>25050</td>
<td class="instruction">LD (<a href="28088.html#28092">28092</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="25053"></span>25053</td>
<td class="instruction">LD HL,<a href="28088.html#28095">28095</a></td>
<td class="comment-1" rowspan="10">Clear the four maze background tiles in the temporary guard buffer.</td>
</tr>
<tr>
<td class="address-1"><span id="25056"></span>25056</td>
<td class="instruction">LD C,4</td>
</tr>
<tr>
<td class="address-2"><span id="25058"></span>25058</td>
<td class="instruction">LD (HL),62</td>
</tr>
<tr>
<td class="address-1"><span id="25060"></span>25060</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="25061"></span>25061</td>
<td class="instruction">LD B,8</td>
</tr>
<tr>
<td class="address-2"><span id="25063"></span>25063</td>
<td class="instruction">LD (HL),0</td>
</tr>
<tr>
<td class="address-1"><span id="25065"></span>25065</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="address-1"><span id="25066"></span>25066</td>
<td class="instruction">DJNZ <a href="24576.html#25063">25063</a></td>
</tr>
<tr>
<td class="address-1"><span id="25068"></span>25068</td>
<td class="instruction">DEC C</td>
</tr>
<tr>
<td class="address-1"><span id="25069"></span>25069</td>
<td class="instruction">JR NZ,<a href="24576.html#25058">25058</a></td>
</tr>
<tr>
<td class="address-1"><span id="25071"></span>25071</td>
<td class="instruction">CALL <a href="27242.html">27242</a></td>
<td class="comment-1" rowspan="1">Copy the guard's buffer back to the original location.</td>
</tr>
<tr>
<td class="address-1"><span id="25074"></span>25074</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the guard counter to <span class="register">B</span>.</td>
</tr>
<tr>
<td class="address-1"><span id="25075"></span>25075</td>
<td class="instruction">DJNZ <a href="24576.html#25017">25017</a></td>
<td class="comment-1" rowspan="1">Jump back to prepare the next guard.</td>
</tr>
<tr>
<td class="address-1"><span id="25077"></span>25077</td>
<td class="instruction">LD HL,(<a href="28623.html#28629">28629</a>)</td>
<td class="comment-1" rowspan="1">Pick up Horace's initial location for the current maze.</td>
</tr>
<tr>
<td class="address-1"><span id="25080"></span>25080</td>
<td class="instruction">LD (<a href="31851.html">31851</a>),HL</td>
<td class="comment-1" rowspan="2">Initialise Horace's current and new locations.</td>
</tr>
<tr>
<td class="address-1"><span id="25083"></span>25083</td>
<td class="instruction">LD (<a href="31853.html">31853</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="25086"></span>25086</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="2">Initialise Horace's animation frame.</td>
</tr>
<tr>
<td class="address-1"><span id="25088"></span>25088</td>
<td class="instruction">LD (<a href="31856.html">31856</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="25091"></span>25091</td>
<td class="instruction">LD A,(<a href="31842.html">31842</a>)</td>
<td class="comment-1" rowspan="2">Initialise the sprite movement timer (using the value of the game speed parameter).</td>
</tr>
<tr>
<td class="address-1"><span id="25094"></span>25094</td>
<td class="instruction">LD (<a href="31841.html">31841</a>),A</td>
</tr>
<tr>
<td class="address-1"><span id="25097"></span>25097</td>
<td class="instruction">LD HL,(<a href="31859.html">31859</a>)</td>
<td class="comment-1" rowspan="2">Print the score and make a sound effect.</td>
</tr>
<tr>
<td class="address-1"><span id="25100"></span>25100</td>
<td class="instruction">CALL <a href="26017.html#26055">26055</a></td>
</tr>
<tr>
<td class="address-1"><span id="25103"></span>25103</td>
<td class="instruction">LD HL,(<a href="31861.html">31861</a>)</td>
<td class="comment-1" rowspan="1">Pick up the high score.</td>
</tr>
<tr>
<td class="address-1"><span id="25106"></span>25106</td>
<td class="instruction">LD DE,16384</td>
<td class="comment-1" rowspan="5">Set <span class="register">DE</span> to the display file address for the high score (in a roundabout way).</td>
</tr>
<tr>
<td class="address-1"><span id="25109"></span>25109</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="address-1"><span id="25110"></span>25110</td>
<td class="instruction">LD BC,26</td>
</tr>
<tr>
<td class="address-1"><span id="25113"></span>25113</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="address-1"><span id="25114"></span>25114</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="address-1"><span id="25115"></span>25115</td>
<td class="instruction">CALL <a href="27425.html">27425</a></td>
<td class="comment-1" rowspan="1">Print the high score.</td>
</tr>
<tr>
<td class="address-1"><span id="25118"></span>25118</td>
<td class="instruction">LD HL,0</td>
<td class="comment-1" rowspan="2">Initialise the guard panic timer.</td>
</tr>
<tr>
<td class="address-1"><span id="25121"></span>25121</td>
<td class="instruction">LD (<a href="28078.html">28078</a>),HL</td>
</tr>
<tr>
<td class="address-1"><span id="25124"></span>25124</td>
<td class="instruction">LD A,57</td>
<td class="comment-1" rowspan="2">Initialise Horace's attribute byte (INK 1: PAPER 7).</td>
</tr>
<tr>
<td class="address-1"><span id="25126"></span>25126</td>
<td class="instruction">LD (<a href="31857.html">31857</a>),A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<div class="comments">
<div class="paragraph">
This routine continues into the main loop at <a href="25129.html">25129</a>.
</div>
</div>
</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
</td>
<td class="up">Up: <a href="../maps/all.html#24576">Map</a></td>
<td class="next">
Next: <a href="25129.html">25129</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Hungry Horace RAM disassembly 20200729</div>
<div class="copyright">&#169; 1982 Beam Software. &#169; 2020 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.2.</div>
<div><a href="../../asm/6000.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>