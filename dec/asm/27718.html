<!DOCTYPE html>
<html>
<head>
<title>Hungry Horace: Routine at 27718</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Hungry Horace" src="../../images/logo-dec.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="27680.html">27680</a>
</td>
<td class="up">Up: <a href="../maps/all.html#27718">Map</a></td>
<td class="next">
Next: <a href="27752.html">27752</a>
</td>
</tr>
</table>
<div class="description">27718: Check the attribute byte at a sprite tile location</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="27680.html">27680</a>.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">E</td>
<td class="register-desc">0, or attribute value from previous call</td>
</tr>
<tr>
<td class="register">HL</td>
<td class="register-desc">Attribute file address</td>
</tr>
</table>
<table class="output">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>
<tr>
<td class="register">E</td>
<td class="register-desc">58 (cherry/strawberry), 59 (guard), 60 (flower), or 0 (none of these)</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="address-2"><span id="27718"></span>27718</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1">Pick up the attribute byte.</td>
</tr>
<tr>
<td class="address-1"><span id="27719"></span>27719</td>
<td class="instruction">CP 59</td>
<td class="comment-1" rowspan="1">Is it magenta?</td>
</tr>
<tr>
<td class="address-1"><span id="27721"></span>27721</td>
<td class="instruction">JR Z,<a href="27718.html#27733">27733</a></td>
<td class="comment-1" rowspan="1">Jump if so (there is a guard here).</td>
</tr>
<tr>
<td class="address-1"><span id="27723"></span>27723</td>
<td class="instruction">CP 58</td>
<td class="comment-1" rowspan="1">Is it red?</td>
</tr>
<tr>
<td class="address-1"><span id="27725"></span>27725</td>
<td class="instruction">JR Z,<a href="27718.html#27736">27736</a></td>
<td class="comment-1" rowspan="1">Jump if so (there is a cherry or strawberry here).</td>
</tr>
<tr>
<td class="address-1"><span id="27727"></span>27727</td>
<td class="instruction">CP 60</td>
<td class="comment-1" rowspan="1">Is it green?</td>
</tr>
<tr>
<td class="address-1"><span id="27729"></span>27729</td>
<td class="instruction">JR Z,<a href="27718.html#27745">27745</a></td>
<td class="comment-1" rowspan="1">Jump if so (there is a flower here).</td>
</tr>
<tr>
<td class="address-1"><span id="27731"></span>27731</td>
<td class="instruction">JR <a href="27718.html#27751">27751</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="27733"></span>27733</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=59 (guard).</td>
</tr>
<tr>
<td class="address-1"><span id="27734"></span>27734</td>
<td class="instruction">JR <a href="27718.html#27751">27751</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="27736"></span>27736</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=58 (cherry or strawberry).</td>
</tr>
<tr>
<td class="address-1"><span id="27737"></span>27737</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="2">Have we already detected a guard at the sprite's location?</td>
</tr>
<tr>
<td class="address-1"><span id="27738"></span>27738</td>
<td class="instruction">CP 59</td>
</tr>
<tr>
<td class="address-1"><span id="27740"></span>27740</td>
<td class="instruction">JR Z,<a href="27718.html#27751">27751</a></td>
<td class="comment-1" rowspan="1">Jump if so (it doesn't matter that there's also a cherry or strawberry here).</td>
</tr>
<tr>
<td class="address-1"><span id="27742"></span>27742</td>
<td class="instruction">LD E,D</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=58 (cherry or strawberry).</td>
</tr>
<tr>
<td class="address-1"><span id="27743"></span>27743</td>
<td class="instruction">JR <a href="27718.html#27751">27751</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="27745"></span>27745</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=60 (flower).</td>
</tr>
<tr>
<td class="address-1"><span id="27746"></span>27746</td>
<td class="instruction">LD A,E</td>
<td class="comment-1" rowspan="2">Have we already detected a guard, cherry, strawberry or flower at the sprite's location?</td>
</tr>
<tr>
<td class="address-1"><span id="27747"></span>27747</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="27748"></span>27748</td>
<td class="instruction">JR NZ,<a href="27718.html#27751">27751</a></td>
<td class="comment-1" rowspan="1">Jump if so.</td>
</tr>
<tr>
<td class="address-1"><span id="27750"></span>27750</td>
<td class="instruction">LD E,D</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=60 (flower).</td>
</tr>
<tr>
<td class="address-2"><span id="27751"></span>27751</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="27680.html">27680</a>
</td>
<td class="up">Up: <a href="../maps/all.html#27718">Map</a></td>
<td class="next">
Next: <a href="27752.html">27752</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Hungry Horace RAM disassembly 20221122</div>
<div class="copyright">&#169; 1982 Beam Software. &#169; 2022 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.8.</div>
<div><a href="../../asm/6C46.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>